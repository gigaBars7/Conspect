# CONSPECT

**CONSPECT** — это многостадийный пайплайн для извлечения текста с фотографий экранов и досок.

Проект предназначен для автоматической обработки фотографий учебных материалов и презентаций.

Он выполняет:
* детекцию и выравнивание экрана/доски
* разрезание изображения на смысловые элементы
* распознавание текста (OCR)
* сбор итогового текстового файла

Архитектура построена по принципу пайплайна с промежуточным кэшем.

---
## Архитектура

Pipeline построен как последовательность стадий:
```
images/ → Stage 1 → Stage 2 → Stage 3 → result.txt
```

Stage 1 — Whiteboard Detection
* Детекция экрана/доски (YOLO)
* Перспективное выравнивание
* Сохранение результата в кэш

Stage 2 — Class Cutter
* Нарезка изображения на элементы
* Классификация сегментов
* Сохранение в подпапке class\_cutter

Stage 3 — OCR
* Распознавание текста
* Поддержка:
	* Tesseract
	* EasyOCR
	* комбинированного режима
* Формирование итогового текстового файла

---

## Основные компоненты

### Cache

Работа с промежуточным хранилищем:
* создание и очистка кэша
* создание папок для стадий
* получение списка изображений и директорий

### WorkerProcess

Обёртка над subprocess-воркером:
* запуск
* отправка JSON-сообщений
* ожидание ответа
* корректное завершение

### Stage

Базовый шаблон стадии пайплайна. Позволяет переопределять:
* способ получения входных данных
* формирование payload
* обработку успеха/ошибки
* сохранение результата

### ResultWriter

Отвечает за:
* буферизацию текста
* поддержку разных OCR-режимов
* запись итогового файла

---
## Структура проекта (src)

```
src/
│
├── core.py
├── whiteboard_worker.py
├── class_cutter_worker.py
├── baseOCR2_worker.py
│
├── images/           # входные изображения
├── cache/            # временные данные
└── result.txt        # итоговый файл
```

---
## Зависимости

Python-зависимости:
- opencv-python (cv2)
- numpy
- ultralytics (YOLO)
- pytesseract
- easyocr

Установка Python-зависимостей:
``` sh
pip install -U opencv-python numpy ultralytics pytesseract easyocr
pip install -U torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu121
```

Установка системных зависимостей:
``` sh
sudo apt update
sudo apt install -y tesseract-ocr tesseract-ocr-rus tesseract-ocr-eng libgl1 libglib2.0-0
```

---
## Запуск

Из директории **src**:
``` sh
python core.py
```

После запуска отобразятся текущие настройки. Их можно принять или изменить.

---





























